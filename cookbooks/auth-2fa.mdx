---
title: "Autenticação (Meta Auth)"
description: "Como enviar códigos OTP com botões de Autocópia e preenchimento automático."
---

# Cookbook: Templates de Autenticação (OTP)

A forma mais segura e com maior taxa de conversão para enviar códigos de verificação é através dos **Authentication Templates** da Meta. Eles permitem que o usuário copie o código com um único toque ou preencha automaticamente no seu App.

## 1. Por que usar o Padrão Meta Auth?

Diferente de um template de texto comum, o template de autenticação oferece:
- **Botão de Autocópia**: Um botão "Copiar Código" aparece diretamente na notificação.
- **Segurança Reforçada**: A Meta aplica proteções extras contra spam para esta categoria.
- **UX Superior**: Reduz a fricção de troca de abas no celular.

---

## 2. Configurando no Dashboard

Ao criar um template, selecione a categoria **AUTHENTICATION**.

### Estrutura Recomendada:
- **Corpo**: "Seu código de verificação para Arara é {{1}}."
- **Rodapé**: "Este código expira em 5 minutos."
- **Botão**: Adicione um botão do tipo **OTP** (One-Time Password) com o rótulo "Copiar Código".

---

## 3. Implementação via API

No momento do envio, você deve passar apenas a variável do código. A Arara cuida para que o botão de autocópia funcione perfeitamente.

```javascript
const sendAuthOTP = async (phone, otpCode) => {
  const response = await fetch('https://api.ararahq.com/api/v1/messages', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      receiver: `whatsapp:${phone}`,
      templateName: 'login_verification_otp',
      variables: [otpCode] // O código que será exibido e copiado
    })
  });
  
  return response.json();
};

// Exemplo: Gerando e enviando
const pin = "482931";
sendAuthOTP("+5511999999999", pin);
```

---

## Dicas Master de Segurança

### Expiração Curta
Recomendamos que códigos de autenticação tenham validade de **5 a 10 minutos**. A Arara registra o `createdAt` para que seu sistema possa validar a janela de tempo pelo Webhook.

### Proteção de Rate Limit
Para evitar ataques de força bruta, a Arara já aplica um **Escudo de Proteção** que limita tentativas excessivas de envio para o mesmo número em um curto intervalo.

---

## Próximos Passos

<CardGroup cols={2}>
  <Card title="Smart Links" icon="link" href="/cookbooks/marketing-smartlinks">
    Rastreie cliques em campanhas.
  </Card>
  <Card title="Escudo de Erros" icon="shield" href="/erros">
    Trate falhas de entrega de OTP.
  </Card>
</CardGroup>
